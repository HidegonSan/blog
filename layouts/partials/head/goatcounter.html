{{/*  Load only in production environment  */}}

{{- if (eq hugo.Environment "production") -}}

    {{- $goatcounter_license    := (resources.Get "js/goatcounter_license.js") -}}
    {{- $goatcounter            := (resources.Get "js/goatcounter.js") | minify -}}
    {{- $goatcounter_bundled     := (slice $goatcounter_license $goatcounter) | resources.Concat "js/goatcounter.js" -}}

    {{- with $goatcounter_bundled | fingerprint -}}
        <script
            defer
            crossorigin="anonymous"
            src="{{- .RelPermalink -}}"
            integrity="{{- .Data.Integrity -}}"
            data-goatcounter="https://hidegon.goatcounter.com/count"
        ></script>
    {{- end -}}

{{- end -}}
